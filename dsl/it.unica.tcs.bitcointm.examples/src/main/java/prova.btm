
package it.unica.btm.prova

network mainnet  

key kA = [
	"KzKP2XkH93yuXTLFPMYE89WvviHSmgKF3CjYKfpkZn6qij1pWuMW",		// mainnet, compressed, encoded (address)
	"1GT4D2wfwu7gJguvEdZXAKcENyPxinQqpz"]

key kB = [
	"KzKP2XkH93yuXTLFPMYE89WvviHSmgKF3CjYKfpkZn6qij1pWuMW",		// mainnet, compressed, encoded (address)
	"1GT4D2wfwu7gJguvEdZXAKcENyPxinQqpz"]
	
//key kA = [ 
//	"cQgNVSk8a7gAgtoWmmMMVU1zYwarS8Qw7Et1S6HG4tkqyU6FmFUC",		// testnet, compressed, encoded (address)
//	"mvy1W62ekvYw5oPXxCXtzEpZExzfhFxSn2"]
	 
  

transaction coinbase = _

transaction ALFA = {
	input = coinbase: true
	output = [
		1 BTC: fun(n) . n==42;			// P2SH
		1 BTC: fun(y) . versig(kB; y);	// P2PKH
		0 BTC: "DATA"					// OP_RETURN 
	]
}

//transaction ALFA_serial = "01000000017acf6994b653ebddde17aeef1be904fc9bd60e05b8316a942de28fa8fd4244e9000000000151ffffffff0300e1f5050000000017a9144b72af382a4d07269c1379f937b17c0a4f25af448700e1f5050000000017a914a3f8ae3c775711c597ef7fdcfd5c3bfc2b6c47c4870000000000000000066a044441544100000000"
transaction ALFA_serial   = "01000000017acf6994b653ebddde17aeef1be904fc9bd60e05b8316a942de28fa8fd4244e9000000000151ffffffff0300e1f5050000000017a9144b72af382a4d07269c1379f937b17c0a4f25af448700e1f505000000001976a914a9776115106b0599bf5f6f82c22e83429babad4d88ac0000000000000000066a044441544100000000"


transaction T = {
	input = coinbase@0: sig kA AIAO
	output = [
		0.00000546 BTC:		fun(n) . n!=42 ;
		0.00000546 BTC:		fun(n) . n=="abc";
		546:				fun(x:signature, y:signature) . y==x; 
		550:				fun(y1) . versig(kB; y1) && 2==2;
		550:				fun(y2, n2: int, b:bool) . versig(kB; y2) && 2==n2 && b 
	]
 
	tlock = 97
}

transaction T1 = {
	input = [
		T@0: (0.00000043 BTC); 
		T@1: if (10+2==12) then "abc" else "xyz";
		T@2: sig kA AIAO sig kA AIAO;
		T@3: sig kA AIAO; 
		T@4: sig kA AIAO 2 (sig kA AIAO==sig kA);
		
//		ALFA@0:	42 ;
//		ALFA@1:	sig kB;
		ALFA_serial@0:	42 [fun(n) . n==42];	// P2SH
		ALFA_serial@1:	sig kB 
	]
	 
	output = [  
		4444: 	2147483647 + 1; 
		2222:	fun (a) . a-45;
		1111:	if (12==10+2) then 3 else 4
	] 
}

 
/*
 * P2SH
 */ 

transaction A = {
	input = coinbase: 	true 
	output= 2BTC:		fun(n:int). n==45
}

transaction B = {
	input = A@0: 45
	output= 1BTC: fun(n:int). n==43
} 

transaction Th = { 
	input = coinbase: sig kA
	output = 10 BTC: 
		fun(secret:string, h:hash). 
//			sha256(secret)==sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 && 
//			hash256(secret)==hash256:5df6e0e2761359d30a8275058e299fcc0381534545f55cf43e41983f5d4c9456 &&
//			h==sha256(5) &&
//			h==sha256:a25513c7e0f6eaa80a3337ee18081b9e2ed09e00af8531c8f7bb2542764027e7 && 
			h==h &&
			sha256(sha256(5)) == hash256(5)
} 

transaction Th1 = {
	input = Th: "" sha256:a25513c7e0f6eaa80a3337ee18081b9e2ed09e00af8531c8f7bb2542764027e4
	output = 0: "HELLO WORLD"    
}
